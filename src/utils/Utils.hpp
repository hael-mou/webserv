//  ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£§‚£¶‚£¥‚£∂‚£æ‚£ø‚£∂‚£∂‚£∂‚£∂‚£¶‚£§‚£Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä                                              
//  ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚°∂‚†ª‚†õ‚†ü‚†ã‚†â‚†Ä‚†à‚†§‚†¥‚†∂‚†∂‚¢æ‚£ø‚£ø‚£ø‚£∑‚£¶‚†Ñ‚†Ä‚†Ä‚†Ä          ìêì  Utils.hpp ìêî           
//  ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚†î‚†ã‚†Ä‚†Ä‚†§‚†í‚†í‚¢≤‚†Ä‚†Ä‚†Ä‚¢Ä‚£†‚£§‚£§‚£¨‚£Ω‚£ø‚£ø‚£ø‚£∑‚£Ñ‚†Ä‚†Ä                                              
//  ‚†Ä‚†Ä‚†Ä‚£Ä‚£é‚¢§‚£∂‚£æ‚†Ö‚†Ä‚†Ä‚¢Ä‚°§‚†è‚†Ä‚†Ä‚†Ä‚††‚£Ñ‚£à‚°ô‚†ª‚¢ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£¶‚†Ä  Student: oezzaou <oezzaou@student.1337.ma> 
//  ‚¢Ä‚†î‚†â‚†Ä‚†ä‚†ø‚†ø‚£ø‚†Ç‚††‚†¢‚£§‚†§‚£§‚£º‚£ø‚£∂‚£∂‚£§‚£ù‚£ª‚£∑‚£¶‚£ç‚°ª‚£ø‚£ø‚£ø‚£ø‚°Ä                                              
//  ‚¢æ‚£æ‚£Ü‚£§‚£§‚£Ñ‚°Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†â‚¢ª‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á                                              
//  ‚†Ä‚†à‚¢ã‚¢π‚†ã‚†â‚†ô‚¢¶‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚£º‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚°á     Created: 2024/05/15 11:58:00 by oezzaou
//  ‚†Ä‚†Ä‚†Ä‚†ë‚†Ä‚†Ä‚†Ä‚†à‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚£†‚£æ‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†á     Updated: 2024/05/30 14:05:50 by hael-mou
//  ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚°á‚†Ä‚†Ä‚¢Ä‚£æ‚£ø‚£ø‚†ø‚†ü‚†õ‚†ã‚†õ‚¢ø‚£ø‚£ø‚†ª‚£ø‚£ø‚£ø‚£ø‚°ø‚†Ä                                             
//  ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚†á‚†Ä‚¢†‚£ø‚£ü‚£≠‚£§‚£∂‚£¶‚£Ñ‚°Ä‚†Ä‚†Ä‚†à‚†ª‚†Ä‚†ò‚£ø‚£ø‚£ø‚†á‚†Ä                                            
//  ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†±‚†§‚†ä‚†Ä‚¢Ä‚£ø‚°ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚£ø‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ò‚£ø‚†è‚†Ä‚†Ä                             ìÜ©‚ôïìÜ™      
//  ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚°Ñ‚†Ä‚†Ä‚†Ä‚†ò‚¢ß‚°Ä‚†Ä‚†Ä‚†∏‚£ø‚£ø‚£ø‚†ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ê‚†ã‚†Ä‚†Ä‚†Ä                        ìÑÇ oussama ezzaouìÜÉ
//  ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ò‚†Ñ‚£Ä‚°Ä‚†∏‚†ì‚†Ä‚†Ä‚†Ä‚††‚†ü‚†ã‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä                                              

#ifndef   __UTILS_HPP__
# define   __UTILS_HPP__

/*******************************************************************************
    * Includes :
*******************************************************************************/
# include "shared_ptr.hpp"
# include "typedefs.hpp"

# include <sstream>
# include <cstring>
# include <string>
# include <cstdio>
# include <ctime>

# include <sys/socket.h>
# include <netinet/in.h> 
# include <sys/types.h>
# include <arpa/inet.h>
# include <sys/stat.h>
# include <stdlib.h> 
# include <unistd.h>
# include <fcntl.h>
# include <netdb.h>

/*******************************************************************************
    * string Utils :
*******************************************************************************/
namespace str
{
    string        strtrim(const string& str);
    string        toLower(const string& str);
    StringPair    lineToPair(const string& line, const char sep);
    StringVector  split(const string str, const char sep);
    string        addrtoString(const in_addr_t& addr, const socklen_t& addrLen);
    string&       replace(string& str, const string& from, const string& to);
    int           strToInt(const string& str); 
    char**        to_Array(const StringVector& strVector);

    template <typename T>
    string    to_string(const T& number)
    {
        std::ostringstream oss;
        oss << number;
        return (oss.str());
    };
};

/*******************************************************************************
    * Logger Utils :
*******************************************************************************/
namespace Logger
{
    void       log(const string& level, const string& message, int fd = 1);
    string     getcurrentTime(const char* format = "%a %b %d %Y %H:%M:%S %Z");
};

/*******************************************************************************
    * Socket Utils :
*******************************************************************************/
namespace sock
{
    Handle  createSocket(int family, int type, int protocol);
    void    bind(Handle socket, const string& host, const string& port);
    void    startListening(Handle socket, int backlog = 10);
    void    setReuseAddr(Handle& socket);
    void    setNonBlocking(Handle& socket);

}

/*******************************************************************************
    * File Utils :
*******************************************************************************/
namespace file
{
    bool       fileExists(const string& path);
    string     generateTempFileName(const string& dir);
    fd_t       createFile(const string& path);
    ssize_t    getFileSize(fd_t fd);
    void       closeFile(fd_t fd);
    void       removeFile(const string& path);
    string     getExtension(const string& file);
    bool       isDirectory(const string& path);
}

/*******************************************************************************
    * Http Utils :
********************************************************************************/
namespace http
{
    std::string tmpDir(const std::string& dir);
    bool        isSpecialChars(const char &c);
    bool        isValidHeader(const char &c);
    bool        isValidMethod(const string& method);
    bool        isValidProtocol(const string& protocol);
    void        decoder(string &str);
    std::string getRelativePath(const string& reqUri, const string& locaUri);
    bool        isCgiPath(const string& path, const StringVector& cgiExt);
}

/*******************************************************************************
    * http Special Chars :
*******************************************************************************/
namespace http
{
    enum SpecialChars{
    Dot                 = '.',
    Dash                =  '-',
    Plus                = '+',
    Comma               = ',',
    Slash               = '/',
    Colon               = ':',
    Space               = ' ',
    Equals              = '=',
    Asterisk            = '*',
    Ampersand           = '&',
    Underscore          ='_',
    QuestionMark        = '?',
    ExclamationMark     = '!',
    LeftCurlyBracket    = '{',
    LeftSquareBracket   = '[',
    RightCurlyBracket   = '}',
    RightSquareBracket  = ']',
    };
}

/*********************************************************************************
    * Status Code :
*******************************************************************************/
namespace http
{
    enum StatusCode
    {
        CONTINUE                        = 100,
        SWITCHING_PROTOCOLS             = 101,
        PROCESSING                      = 102,
        EARLY_HINTS                     = 103,

        OK                              = 200,
        CREATED                         = 201,
        ACCEPTED                        = 202,
        NON_AUTHORITATIVE               = 203,
        NO_CONTENT                      = 204,
        RESET_CONTENT                   = 205,
        PARTIAL_CONTENT                 = 206,
        MULTI_STATUS                    = 207,
        ALREADY_REPORTED                = 208,
        IM_USED                         = 226,

        MULTIPLE_CHOICES                = 300,
        MOVED_PERMANENTLY               = 301,
        MOVED_TEMPORARILY               = 302,
        SEE_OTHER                       = 303,
        NOT_MODIFIED                    = 304,
        USE_PROXY                       = 305,
        SWITCH_PROXY                    = 306,
        TEMPORARY_REDIRECT              = 307,
        PERMANENT_REDIRECT              = 308,

        BAD_REQUEST                     = 400,
        UNAUTHORIZED                    = 401,
        PAYMENT_REQUIRED                = 402,
        FORBIDDEN                       = 403,
        NOT_FOUND                       = 404,
        METHOD_NOT_ALLOWED              = 405,
        NOT_ACCEPTABLE                  = 406,
        REQUEST_TIMEOUT                 = 408,
        CONFLICT                        = 409,
        GONE                            = 410,
        LENGTH_REQUIRED                 = 411,
        PRECONDITION_FAILED             = 412,
        PAYLOAD_TOO_LARGE               = 413,
        URI_TOO_LONG                    = 414,
        UNSUPPORTED_MEDIA_TYPE          = 415,
        RANGE_NOT_SATISFIABLE           = 416,
        EXPECTATION_FAILED              = 417,
        IM_A_TEAPOT                     = 418,
        MISDIRECTED_REQUEST             = 421,

        INTERNAL_SERVER_ERROR           = 500,
        NOT_IMPLEMENTED                 = 501,
        BAD_GATEWAY                     = 502,
        SERVICE_UNAVAILABLE             = 503,
        GATEWAY_TIMEOUT                 = 504,
        VERSION_NOT_SUPPORTED           = 505,
        INSUFFICIENT_STORAGE            = 507,
        LOOP_DETECTED                   = 508,
        NOT_EXTENDED                    = 510,
    };
}

#endif /* __UTILS_HPP__ */
